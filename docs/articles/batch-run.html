<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Batch run • VeRitas</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Batch run">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VeRitas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/batch-run.html">Batch run</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/koenvanbenthem/VeRitas/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Batch run</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/koenvanbenthem/VeRitas/blob/HEAD/vignettes/batch-run.Rmd" class="external-link"><code>vignettes/batch-run.Rmd</code></a></small>
      <div class="d-none name"><code>batch-run.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="analysing-multiple-scripts-at-once">Analysing multiple scripts at once<a class="anchor" aria-label="anchor" href="#analysing-multiple-scripts-at-once"></a>
</h2>
<p><strong>important note</strong> <em>evaluating submitted scripts
requires their evaluation. I.e. the code will be run on the machine
where the batch run is initiated. We encourage you to only run this code
within a docker container or virtual machine. R code can be written that
overwrites or deletes all your existing files or download malicious
files from the web. Be extremely careful when running this code on your
own machine. We take no responsibility for any damage to your
machine.</em></p>
<p>As with the single run, we first define a net. We work with the same
assignment as on the main page (write code that sums the squares of the
number 1 up to 5).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/koenvanbenthem/VeRitas" class="external-link">VeRitas</a></span><span class="op">)</span></span>
<span><span class="va">net</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="fu"><a href="../reference/has_val.html">has_val</a></span><span class="op">(</span><span class="va">ref</span><span class="op">$</span><span class="va">sol</span><span class="op">)</span>,</span>
<span>                       goT<span class="op">=</span><span class="va">S2</span>,goF<span class="op">=</span><span class="va">S1</span>,</span>
<span>                       doT<span class="op">=</span><span class="st">"[✓] Sum is found!"</span>,</span>
<span>                       doF<span class="op">=</span><span class="st">"[x] Sum not found"</span><span class="op">)</span>,</span>
<span>            </span>
<span>            S1<span class="op">=</span><span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="fu"><a href="../reference/has_val.html">has_val</a></span><span class="op">(</span><span class="va">ref</span><span class="op">$</span><span class="va">wrongsol</span><span class="op">)</span>,</span>
<span>                    goT<span class="op">=</span><span class="va">END</span>,goF<span class="op">=</span><span class="va">END</span>,</span>
<span>                    doT<span class="op">=</span><span class="st">"[?] Did you square?"</span><span class="op">)</span>,</span>
<span>            </span>
<span>            S2<span class="op">=</span><span class="fu"><a href="../reference/node.html">node</a></span><span class="op">(</span><span class="fu"><a href="../reference/did_call.html">did_call</a></span><span class="op">(</span><span class="st">"sum"</span>,<span class="st">"base"</span><span class="op">)</span>,</span>
<span>                    goT<span class="op">=</span><span class="va">END</span>,goF<span class="op">=</span><span class="va">END</span>,</span>
<span>                    doF<span class="op">=</span><span class="st">"[?] Could the sum function help?"</span><span class="op">)</span></span>
<span>            <span class="op">)</span></span>
<span><span class="va">MyAssignment</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepareAssignment.html">prepareAssignment</a></span><span class="op">(</span><span class="va">net</span>,<span class="st">"../examples/01-simplest/ref1.R"</span><span class="op">)</span></span></code></pre></div>
<p>Now, with the prepared assignment, we can do a batch run. This finds
all .R files in the supplied directory and then runs them through
VeRitas.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">batchout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runBatch.html">runBatch</a></span><span class="op">(</span>dirname <span class="op">=</span>  <span class="st">"../examples/01-simplest/batch-run"</span>,</span>
<span>                     assignment <span class="op">=</span> <span class="va">MyAssignment</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; The following files have been found:</span></span>
<span><span class="co">#&gt; code1.R</span></span>
<span><span class="co">#&gt; code2.R</span></span>
<span><span class="co">#&gt; code3.R</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #BB0000; font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #BB0000; font-weight: bold;">#&gt; If you proceed - all these R files will be executed, with potentially harmful consequences to your computer. Are you certain you want to proceed? Proceeding is entirely at your own risk!</span></span></span>
<span><span class="co"><span style="color: #BB0000; font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #BB0000; font-weight: bold;">#&gt; </span>Do you wish to run all these R files? (yes/no)</span></span></code></pre>
<p>We can now use extractFeedback to extract the feedback for each
submission into a data frame:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allfeedback</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extractFeedback.html">extractFeedback</a></span><span class="op">(</span><span class="va">batchout</span><span class="op">)</span></span>
<span><span class="va">allfeedback</span></span>
<span><span class="co">#&gt;                                    filename</span></span>
<span><span class="co">#&gt; 1 ../examples/01-simplest/batch-run/code1.R</span></span>
<span><span class="co">#&gt; 2 ../examples/01-simplest/batch-run/code2.R</span></span>
<span><span class="co">#&gt; 3 ../examples/01-simplest/batch-run/code3.R</span></span>
<span><span class="co">#&gt;                                                feedback</span></span>
<span><span class="co">#&gt; 1              [x] Sum not found\n\n[?] Did you square?</span></span>
<span><span class="co">#&gt; 2 [✓] Sum is found!\n\n[?] Could the sum function help?</span></span>
<span><span class="co">#&gt; 3                                     [✓] Sum is found!</span></span></code></pre></div>
<p>We can also print specific feedback with the cat function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">allfeedback</span><span class="op">$</span><span class="va">feedback</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [x] Sum not found</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [?] Did you square?</span></span></code></pre></div>
<p>Furthermore it is possible to draw an overview of how the scripts
were run through the evaluation net using the analyseBatch function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'igraph' was built under R version 4.4.3</span></span>
<span><span class="fu"><a href="../reference/analyseBatch.html">analyseBatch</a></span><span class="op">(</span><span class="va">batchout</span>,draw<span class="op">=</span><span class="st">"static"</span>,layout<span class="op">=</span><span class="va">layout_as_tree</span>,margin<span class="op">=</span><span class="fl">0.3</span>,</span>
<span>        size<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="batch-run_files/figure-html/unnamed-chunk-6-1.png" width="75%" height="75%" style="display: block; margin: auto;">
Note that in this graph terminal nodes (end nodes) contain the number of
scripts that they contain, while the thickness of the edges corresponds
to the number of scripts that have flowed through that edge. To obtain
the scripts that were at any specific terminal node, use
extractScripts:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extractScripts.html">extractScripts</a></span><span class="op">(</span><span class="va">batchout</span>, <span class="st">"S1"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "../examples/01-simplest/batch-run/code1.R"</span></span></code></pre></div>
<p>Unfortunately it is currently not possible to extract scripts from
end nodes. We are working on this functionality. For now, a workaround
would be to simply add an additional dummy node before the end, which
one can track.</p>
<p>In Rstudio, it is then possible to load such a script using rstudios
api directly. For example to load the first script that is obtained with
the code on line 67, use:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">script</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extractScripts.html">extractScripts</a></span><span class="op">(</span><span class="va">batchout</span>,<span class="st">"S1"</span><span class="op">)</span></span>
<span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-documents.html" class="external-link">documentOpen</a></span><span class="op">(</span><span class="va">script</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This allows for efficient checking of code, and as a teacher one can,
this way relatively easily design new feedback rules.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Koen van Benthem.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
